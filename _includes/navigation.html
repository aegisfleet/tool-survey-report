<nav class="main-navigation" role="navigation" aria-label="メインナビゲーション">
  <button class="nav-toggle" aria-controls="nav-menu" aria-expanded="false" aria-label="メニューを開く">
    <span class="nav-toggle-icon">
      <span></span>
      <span></span>
      <span></span>
    </span>
  </button>

  <ul class="nav-menu" id="nav-menu">
    <li class="nav-item">
      <a href="{{ '/' | relative_url }}" class="nav-link reset-filter-link {% if page.url == '/' %}current{% endif %}">
        ホーム
      </a>
    </li>

    <li class="nav-item nav-item-dropdown">
      <button class="nav-link nav-dropdown-toggle" aria-expanded="false" aria-haspopup="true">
        カテゴリ
        <svg class="dropdown-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M6 9l6 6 6-6" />
        </svg>
      </button>
      <div class="nav-dropdown" role="menu">
        <div class="nav-dropdown-header">
          <span>カテゴリを選択</span>
          <a href="{{ '/categories/' | relative_url }}">すべて見る</a>
        </div>
        {% assign all_categories = site.reports | map: 'category' | uniq | sort %}
        {% for category in all_categories %}
        {% if category and category != '' %}
        {% assign category_reports = site.reports | where: "category", category %}
        <a href="{{ '/' | relative_url }}?category={{ category | url_encode }}" class="nav-dropdown-item"
          role="menuitem">
          {{ category }}
          <span class="dropdown-count">{{ category_reports.size }}</span>
        </a>
        {% endif %}
        {% endfor %}
      </div>
    </li>

    <li class="nav-item">
      <a href="{{ '/tags/' | relative_url }}" class="nav-link {% if page.url contains '/tags/' %}current{% endif %}">
        タグ一覧
      </a>
    </li>


    {%- if site.data.navigation.main_links -%}
    {%- for link in site.data.navigation.main_links -%}
    <li class="nav-item">
      <a href="{{ link.url | relative_url }}" class="nav-link {% if page.url == link.url %}current{% endif %}">
        {{ link.title }}
      </a>
    </li>
    {%- endfor -%}
    {%- endif -%}

    <li class="nav-item nav-item-theme">
      <button class="nav-link theme-toggle"
              aria-label="テーマを切り替える"
              title="ダーク/ライトモード切替">
        <!-- Sun icon (show in dark mode) -->
        <svg class="theme-icon theme-icon-light" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="5"/>
          <line x1="12" y1="1" x2="12" y2="3"/>
          <line x1="12" y1="21" x2="12" y2="23"/>
          <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/>
          <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/>
          <line x1="1" y1="12" x2="3" y2="12"/>
          <line x1="21" y1="12" x2="23" y2="12"/>
          <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/>
          <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/>
        </svg>
        <!-- Moon icon (show in light mode) -->
        <svg class="theme-icon theme-icon-dark" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
        </svg>
      </button>
    </li>
  </ul>
</nav>
