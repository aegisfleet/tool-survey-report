---
layout: default
---

<div class="home-container">
  <header class="home-header">
    <div class="header-image">
      <img src="{{ '/assets/images/default-ogp.png' | relative_url }}" alt="{{ site.title }}" class="ogp-image">
    </div>
  </header>

  <main class="home-content">
    {{ content }}

    <!-- ãƒ©ãƒ³ãƒ€ãƒ ãƒ”ãƒƒã‚¯ã‚¢ãƒƒãƒ— -->
    <section class="random-picks">
      <div class="picks-header">
        <div>
          <h2>ğŸ² ãŠã™ã™ã‚ãƒ”ãƒƒã‚¯ã‚¢ãƒƒãƒ—</h2>
          <p class="picks-desc">ãƒ©ãƒ³ãƒ€ãƒ ã«é¸ã°ã‚ŒãŸ3ã¤ã®ãƒ¬ãƒãƒ¼ãƒˆã‚’ã”ç´¹ä»‹</p>
        </div>
        <button type="button" class="refresh-btn" id="refresh-picks" aria-label="åˆ¥ã®ãƒ¬ãƒãƒ¼ãƒˆã‚’è¡¨ç¤º">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M23 4v6h-6M1 20v-6h6M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15" />
          </svg>
          ã‚·ãƒ£ãƒƒãƒ•ãƒ«
        </button>
      </div>
      <div class="picks-grid" id="random-picks-grid">
        {% assign all_reports = site.reports | sort: 'last_updated' | reverse %}
        {% for report in all_reports limit: 3 %}
        <a href="{{ report.url | relative_url }}" class="pick-card" data-url="{{ report.url | relative_url }}"
          data-title="{{ report.tool_name | default: report.title }}" data-desc="{{ report.description }}">
          {% if report.quick_summary.has_free_plan %}
          <span class="pick-free-badge">ç„¡æ–™ãƒ—ãƒ©ãƒ³ã‚ã‚Š</span>
          {% endif %}
          <span class="pick-title">{{ report.tool_name | default: report.title }}</span>
          <span class="pick-category">{{ report.category }}</span>
          {% if report.evaluation.score %}
          <span class="pick-score">{{ report.evaluation.score }}ç‚¹</span>
          {% endif %}
        </a>
        {% endfor %}
      </div>
    </section>

    <section class="reports-section">
      <div class="reports-header">
        <h2>æœ€æ–°ã®ãƒ¬ãƒãƒ¼ãƒˆ</h2>
        <div class="reports-controls">
          <div class="search-container">
            <input type="text" id="report-search" placeholder="ãƒ„ãƒ¼ãƒ«åã€èª¬æ˜ã€ã‚¿ã‚°ã§æ¤œç´¢..." class="search-input">
            <button type="button" class="search-clear" id="search-clear" aria-label="æ¤œç´¢ã‚’ã‚¯ãƒªã‚¢">Ã—</button>
          </div>

          <div class="filter-container">
            <select id="tag-filter" class="tag-filter">
              <option value="">ã™ã¹ã¦ã®ã‚¿ã‚°</option>
            </select>
            <button type="button" class="filter-clear" id="tag-filter-clear" aria-label="ã‚¿ã‚°ãƒ•ã‚£ãƒ«ã‚¿ã‚’ã‚¯ãƒªã‚¢">Ã—</button>
          </div>
          <div class="sort-container">
            <select id="sort-select" class="sort-select">
              <option value="date-desc" selected>æ–°ã—ã„é †</option>
              <option value="date-asc">å¤ã„é †</option>
              <option value="title-asc">ãƒ„ãƒ¼ãƒ«åé †</option>
            </select>
          </div>
        </div>
      </div>

      <div class="reports-grid" id="reports-grid">
        {% assign sorted_reports = site.reports | sort: 'last_updated' | reverse %}
        {% for report in sorted_reports %}
        <article class="report-card" data-tags="{{ report.tags | join: ',' }}"
          data-title="{{ report.title | downcase }}" data-tool-name="{{ report.tool_name | downcase }}"
          data-description="{{ report.description | downcase }}"
          data-date="{{ report.last_updated | date: '%Y-%m-%d' }}" data-category="{{ report.category | downcase }}"
          data-developer="{{ report.developer | downcase }}">

          {% if report.quick_summary.has_free_plan %}
          <span class="card-free-badge">ğŸ’š ç„¡æ–™ãƒ—ãƒ©ãƒ³ã‚ã‚Š</span>
          {% endif %}

          <div class="report-card-header">
            <h3 class="report-title">
              <a href="{{ report.url | relative_url }}">{{ report.tool_name | default: report.title }}</a>
            </h3>
            <div class="report-header-meta">
              <time class="report-date" datetime="{{ report.last_updated | date: '%Y-%m-%d' }}">
                {{ report.last_updated | date: "%Yå¹´%mæœˆ%dæ—¥" }}
              </time>
              {% if report.evaluation.score %}
              <span class="card-score-badge">{{ report.evaluation.score }}ç‚¹</span>
              {% endif %}
            </div>
          </div>

          {% if report.description %}
          <p class="report-description">{{ report.description }}</p>
          {% endif %}

          <div class="report-meta">
            {% if report.developer %}
            <span class="meta-item developer">
              <svg width="14" height="14" viewBox="0 0 16 16" fill="currentColor">
                <path
                  d="M1.5 1a.5.5 0 0 0-.5.5v3a.5.5 0 0 1-1 0v-3A1.5 1.5 0 0 1 1.5 0h3a.5.5 0 0 1 0 1h-3zM11 .5a.5.5 0 0 1 .5-.5h3A1.5 1.5 0 0 1 16 1.5v3a.5.5 0 0 1-1 0v-3a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 1-.5-.5zM.5 11a.5.5 0 0 1 .5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 1 0 1h-3A1.5 1.5 0 0 1 0 14.5v-3a.5.5 0 0 1 .5-.5zm15 0a.5.5 0 0 1 .5.5v3a1.5 1.5 0 0 1-1.5 1.5h-3a.5.5 0 0 1 0-1h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 1 .5-.5z" />
                <path d="M3 3h10a2 2 0 0 1 2 2v6a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z" />
              </svg>
              {{ report.developer }}
            </span>
            {% endif %}
            {% if report.category %}
            <span class="meta-item category">
              <svg width="14" height="14" viewBox="0 0 16 16" fill="currentColor">
                <path
                  d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z" />
              </svg>
              {{ report.category }}
            </span>
            {% endif %}
          </div>

          {% if report.tags and report.tags.size > 0 %}
          <div class="report-tags">
            {% for tag in report.tags %}
            <span class="tag" data-tag="{{ tag }}">{{ tag }}</span>
            {% endfor %}
          </div>
          {% endif %}

          <div class="report-card-footer">
            <a href="{{ report.url | relative_url }}" class="read-more">ç¶šãã‚’èª­ã‚€ â†’</a>
          </div>
        </article>
        {% endfor %}
      </div>

      {% if site.reports.size == 0 %}
      <div class="no-reports">
        <p>ã¾ã ãƒ¬ãƒãƒ¼ãƒˆãŒã‚ã‚Šã¾ã›ã‚“ã€‚</p>
      </div>
      {% endif %}

      <div class="no-results" id="no-results" style="display: none;">
        <p>æ¤œç´¢æ¡ä»¶ã«ä¸€è‡´ã™ã‚‹ãƒ¬ãƒãƒ¼ãƒˆãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚</p>
      </div>
    </section>

    <section class="stats-section">
      <div class="stats-grid">
        <div class="stat-item">
          <span class="stat-number">{{ site.reports.size }}</span>
          <span class="stat-label">ç·ãƒ¬ãƒãƒ¼ãƒˆæ•°</span>
        </div>
        <div class="stat-item">
          {% assign unique_tags = site.reports | map: 'tags' | join: ',' | split: ',' | uniq | size %}
          <span class="stat-number">{{ unique_tags }}</span>
          <span class="stat-label">ã‚¿ã‚°æ•°</span>
        </div>
      </div>
    </section>
  </main>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const searchInput = document.getElementById('report-search');
    const searchClear = document.getElementById('search-clear');
    const tagFilter = document.getElementById('tag-filter');
    const tagFilterClear = document.getElementById('tag-filter-clear');
    const sortSelect = document.getElementById('sort-select');
    const reportsGrid = document.getElementById('reports-grid');
    const noResults = document.getElementById('no-results');
    const reportCards = Array.from(document.querySelectorAll('.report-card'));

    // Populate tag filter options
    const allTags = new Set();
    reportCards.forEach(card => {
      const tags = card.dataset.tags.split(',').filter(tag => tag.trim());
      tags.forEach(tag => allTags.add(tag.trim()));
    });

    Array.from(allTags).sort().forEach(tag => {
      const option = document.createElement('option');
      option.value = tag;
      option.textContent = tag;
      tagFilter.appendChild(option);
    });

    // Update tag visual states
    function updateTagStates() {
      const selectedTag = tagFilter.value;
      const allTagElements = document.querySelectorAll('.tag');

      allTagElements.forEach(tagElement => {
        const tagValue = tagElement.dataset.tag;
        if (tagValue === selectedTag && selectedTag !== '') {
          tagElement.classList.add('active');
        } else {
          tagElement.classList.remove('active');
        }
      });
    }

    // Filter and sort function
    function filterAndSort() {
      const searchTerm = searchInput.value.toLowerCase().trim();
      const selectedTag = tagFilter.value;
      const sortBy = sortSelect.value;

      let filteredCards = reportCards.filter(card => {
        const matchesSearch = !searchTerm ||
          (card.dataset.toolName && card.dataset.toolName.includes(searchTerm)) ||
          (card.dataset.description && card.dataset.description.includes(searchTerm)) ||
          (card.dataset.developer && card.dataset.developer.includes(searchTerm)) ||
          (card.dataset.tags && card.dataset.tags.toLowerCase().includes(searchTerm));
        const matchesTag = !selectedTag || card.dataset.tags.split(',').map(t => t.trim()).includes(selectedTag);
        return matchesSearch && matchesTag;
      });

      // Sort cards
      filteredCards.sort((a, b) => {
        switch (sortBy) {
          case 'date-desc':
            return new Date(b.dataset.date) - new Date(a.dataset.date);
          case 'date-asc':
            return new Date(a.dataset.date) - new Date(b.dataset.date);
          case 'title-asc':
            return a.dataset.toolName.localeCompare(b.dataset.toolName);
          default:
            return 0;
        }
      });

      // Hide all cards first
      reportCards.forEach(card => card.style.display = 'none');

      // Show filtered and sorted cards
      if (filteredCards.length > 0) {
        filteredCards.forEach(card => {
          card.style.display = 'block';
          reportsGrid.appendChild(card); // Re-append to maintain order
        });
        noResults.style.display = 'none';
      } else {
        noResults.style.display = 'block';
      }

      // Update tag visual states immediately
      updateTagStates();
    }

    // Event listeners
    searchInput.addEventListener('input', filterAndSort);
    tagFilter.addEventListener('change', filterAndSort);
    sortSelect.addEventListener('change', filterAndSort);

    searchClear.addEventListener('click', function () {
      searchInput.value = '';
      filterAndSort();
    });

    tagFilterClear.addEventListener('click', function () {
      tagFilter.value = '';
      filterAndSort();
    });

    // Handle URL parameters for tag filtering
    const urlParams = new URLSearchParams(window.location.search);
    const tagParam = urlParams.get('tag');

    if (tagParam) {
      tagFilter.value = tagParam;
      filterAndSort();
    } else {
      // åˆæœŸçŠ¶æ…‹ã§ã‚‚ã‚¿ã‚°ã®çŠ¶æ…‹ã‚’æ›´æ–°
      updateTagStates();
    }

    // Tag click functionality
    document.addEventListener('click', function (e) {
      if (e.target.classList.contains('tag')) {
        e.preventDefault(); // ã‚¿ãƒƒãƒ—æ™‚ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå‹•ä½œã‚’é˜²ã
        handleTagClick(e.target);
      }
    });

    // ã‚¿ãƒƒãƒã‚¤ãƒ™ãƒ³ãƒˆã‚‚å‡¦ç†ï¼ˆã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³å¯¾å¿œï¼‰
    document.addEventListener('touchend', function (e) {
      if (e.target.classList.contains('tag')) {
        e.preventDefault();
        handleTagClick(e.target);
      }
    });

    // ã‚¿ã‚°ã‚¯ãƒªãƒƒã‚¯å‡¦ç†ã‚’å…±é€šåŒ–
    function handleTagClick(tagElement) {
      const tagValue = tagElement.dataset.tag;

      // åŒã˜ã‚¿ã‚°ãŒæ—¢ã«é¸æŠã•ã‚Œã¦ã„ã‚‹å ´åˆã¯ãƒ•ã‚£ãƒ«ã‚¿ã‚’è§£é™¤
      if (tagFilter.value === tagValue) {
        tagFilter.value = '';
      } else {
        tagFilter.value = tagValue;
      }

      filterAndSort();

      // ã‚¿ãƒƒãƒ—å¾Œã™ãã«ã‚¢ã‚¯ãƒ†ã‚£ãƒ–çŠ¶æ…‹ã‚’ã‚¯ãƒªã‚¢ï¼ˆã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³å¯¾å¿œï¼‰
      tagElement.blur();

      // ä¸€æ™‚çš„ã«ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚¯ãƒ©ã‚¹ã‚’å‰Šé™¤ã—ã¦å†é©ç”¨ï¼ˆè¦–è¦šçš„ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ï¼‰
      setTimeout(() => {
        updateTagStates();
      }, 50);
    }

    // ãƒ©ãƒ³ãƒ€ãƒ ãƒ”ãƒƒã‚¯ã‚¢ãƒƒãƒ—ã®ã‚·ãƒ£ãƒƒãƒ•ãƒ«å‡¦ç†
    function shuffleRandomPicks() {
      const picksGrid = document.getElementById('random-picks-grid');
      if (!picksGrid) return;

      const pickCards = Array.from(picksGrid.querySelectorAll('.pick-card'));
      const allReportCards = Array.from(document.querySelectorAll('.report-card'));

      if (allReportCards.length <= 3) return;

      // ã™ã¹ã¦ã®ãƒ¬ãƒãƒ¼ãƒˆã‹ã‚‰ãƒ©ãƒ³ãƒ€ãƒ ã«3ã¤é¸æŠï¼ˆã‚¹ã‚³ã‚¢ã¨ç„¡æ–™ãƒ—ãƒ©ãƒ³æƒ…å ±ã‚‚å–å¾—ï¼‰
      const shuffled = allReportCards
        .map(card => ({
          url: card.querySelector('a')?.href || '#',
          title: card.querySelector('.report-title a')?.textContent?.trim() || 'Unknown',
          category: card.querySelector('.meta-item.category')?.textContent?.trim() || '',
          score: card.querySelector('.card-score-badge')?.textContent?.trim() || '',
          hasFreePlan: !!card.querySelector('.card-free-badge')
        }))
        .sort(() => Math.random() - 0.5)
        .slice(0, 3);

      // ãƒ”ãƒƒã‚¯ã‚«ãƒ¼ãƒ‰ã‚’æ›´æ–°
      pickCards.forEach((card, index) => {
        if (shuffled[index]) {
          card.href = shuffled[index].url;
          card.querySelector('.pick-title').textContent = shuffled[index].title;
          card.querySelector('.pick-category').textContent = shuffled[index].category;

          // ã‚¹ã‚³ã‚¢ãƒãƒƒã‚¸ã®è¡¨ç¤ºã‚’æ›´æ–°
          let scoreEl = card.querySelector('.pick-score');
          if (shuffled[index].score) {
            if (!scoreEl) {
              // ã‚¹ã‚³ã‚¢è¦ç´ ãŒãªã‘ã‚Œã°ä½œæˆ
              scoreEl = document.createElement('span');
              scoreEl.className = 'pick-score';
              card.appendChild(scoreEl);
            }
            scoreEl.textContent = shuffled[index].score;
            scoreEl.style.display = '';
          } else if (scoreEl) {
            scoreEl.style.display = 'none';
          }

          // ç„¡æ–™ãƒ—ãƒ©ãƒ³ãƒãƒƒã‚¸ã®è¡¨ç¤ºã‚’æ›´æ–°
          let freeBadge = card.querySelector('.pick-free-badge');
          if (shuffled[index].hasFreePlan) {
            if (!freeBadge) {
              // ãƒãƒƒã‚¸è¦ç´ ãŒãªã‘ã‚Œã°ä½œæˆ
              freeBadge = document.createElement('span');
              freeBadge.className = 'pick-free-badge';
              freeBadge.textContent = 'ç„¡æ–™ãƒ—ãƒ©ãƒ³ã‚ã‚Š';
              card.insertBefore(freeBadge, card.firstChild);
            }
            freeBadge.style.display = '';
          } else if (freeBadge) {
            freeBadge.style.display = 'none';
          }
        }
      });
    }

    // ãƒšãƒ¼ã‚¸ãƒ­ãƒ¼ãƒ‰æ™‚ã«ãƒ©ãƒ³ãƒ€ãƒ ã‚·ãƒ£ãƒƒãƒ•ãƒ«
    shuffleRandomPicks();

    // ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒœã‚¿ãƒ³ã®ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ
    const refreshBtn = document.getElementById('refresh-picks');
    if (refreshBtn) {
      refreshBtn.addEventListener('click', function () {
        shuffleRandomPicks();
        // ãƒœã‚¿ãƒ³ã‚’ä¸€ç¬å›è»¢ã•ã›ã‚‹ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
        this.style.transform = 'scale(1.1) rotate(180deg)';
        setTimeout(() => {
          this.style.transform = '';
        }, 300);
      });
    }
  });
</script>